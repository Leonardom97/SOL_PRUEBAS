<!DOCTYPE html>
<html data-bs-theme="light" lang="es-419">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>OSM</title>
    <meta property="og:image" content="assets/img/Sin%20título-2.png">
    <meta property="og:type" content="website">
    <link rel="icon" type="image/png" sizes="697x475" href="assets/img/Sin%20título-2.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="assets/css/bs-theme-overrides.css?v=5">

</head>

<body id="page-top">
    <!-- Logger debe cargarse primero para que esté disponible para otros scripts -->
    <script src="assets/js/logger.js"></script>
    <script src="../assets/js/auth_guard.js?v=2"></script>
    <div id="wrapper">
        <div id="sidebar" style="display: none;"></div> <!-- Sidebar dinámico -->
        <div class="d-flex flex-column" id="content-wrapper">
            <div id="content">
                <div id="navbar"></div> <!-- Navbar dinámico -->

                <div class="container-fluid" id="panel">
                    <div class="d-sm-flex justify-content-between align-items-center mb-4">
                        <h2 class="text-primary mb-0">Bienvenidos</h2>
                    </div>

                    <!-- KPI Row -->
                    <div class="row">
                        <!-- 1. Usuarios Activos -->
                        <div class="col-md-6 col-xl-4 mb-4">
                            <div class="card shadow border-start-primary py-2 h-100">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center mb-2">
                                        <div class="col">
                                            <div class="text-xs font-weight-bold text-primary text-uppercase">
                                                Usuarios Activos</div>
                                        </div>
                                    </div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 font-weight-bold text-gray-800"
                                                id="usuarios-registrados-panel">--</div>
                                        </div>
                                        <div class="col text-end">
                                            <i class="fas fa-users fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 2. Colaboradores -->
                        <div class="col-md-6 col-xl-4 mb-4">
                            <div class="card shadow border-start-success py-2 h-100">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center mb-2">
                                        <div class="col">
                                            <div class="text-xs font-weight-bold text-success text-uppercase">
                                                Colaboradores</div>
                                        </div>
                                    </div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 font-weight-bold text-gray-800"
                                                id="usuarios-colaboradores-panel">--</div>
                                        </div>
                                        <div class="col text-end">
                                            <i class="fas fa-user-tie fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 3. Pesadas (KPI Only) -->
                        <div class="col-md-6 col-xl-4 mb-4" data-role="Administrador">
                            <div class="card shadow border-start-info py-2 h-100">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center mb-2">
                                        <div class="col">
                                            <div class="text-xs font-weight-bold text-info text-uppercase">
                                                Pesadas</div>
                                        </div>
                                        <div class="col-auto d-flex align-items-center">
                                            <select id="select-periodo-pesadas-kpi"
                                                class="form-select border-0 bg-light text-info fw-bold shadow-none"
                                                style="width: auto; font-size: 0.85rem; padding: 6px 30px 6px 12px; cursor: pointer;">
                                                <option value="today">Hoy</option>
                                                <option value="yesterday">Ayer</option>
                                                <option value="week">Semana</option>
                                                <option value="month" selected>Mes</option>
                                                <option value="year">Año</option>
                                                <option value="total">Total</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="pesadas-hoy-panel">
                                                --</div>
                                        </div>
                                        <div class="col text-end">
                                            <i class="fas fa-truck-loading fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 4. Capacitaciones (Con Filtro) -->
                        <div class="col-md-6 col-xl-4 mb-4" data-role="Administrador">
                            <div class="card shadow border-start-warning py-2 h-100">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center mb-2">
                                        <div class="col">
                                            <div class="text-xs font-weight-bold text-warning text-uppercase">
                                                Capacitaciones</div>
                                        </div>
                                        <div class="col-auto d-flex align-items-center">
                                            <select id="select-periodo-capacitaciones"
                                                class="form-select border-0 bg-light text-warning fw-bold shadow-none"
                                                style="width: auto; font-size: 0.85rem; padding: 6px 30px 6px 12px; cursor: pointer;">
                                                <option value="today">Hoy</option>
                                                <option value="yesterday">Ayer</option>
                                                <option value="week">Semana</option>
                                                <option value="month" selected>Mes</option>
                                                <option value="year">Año</option>
                                                <option value="total">Total</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 font-weight-bold text-gray-800"
                                                id="capacitaciones-mes-panel">--</div>
                                        </div>
                                        <div class="col text-end">
                                            <i class="fas fa-chalkboard-teacher fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 5. Evaluaciones Realizadas -->
                        <div class="col-md-6 col-xl-4 mb-4">
                            <div class="card shadow border-start-primary py-2 h-100">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center mb-2">
                                        <div class="col">
                                            <div class="text-xs font-weight-bold text-primary text-uppercase">
                                                Evaluaciones Realizadas</div>
                                        </div>
                                    </div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 font-weight-bold text-gray-800"
                                                id="evaluaciones-realizadas-panel">--</div>
                                        </div>
                                        <div class="col text-end">
                                            <i class="fas fa-clipboard-check fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 6. Fecha Corte -->
                        <div class="col-md-6 col-xl-4 mb-4" data-role="Administrador">
                            <div class="card shadow border-start-danger py-2 h-100">
                                <div class="card-body">
                                    <div class="row no-gutters align-items-center mb-2">
                                        <div class="col">
                                            <div class="text-xs font-weight-bold text-danger text-uppercase">
                                                Fecha Corte</div>
                                        </div>
                                    </div>
                                    <div class="row no-gutters align-items-center">
                                        <div class="col-auto">
                                            <div class="h5 mb-0 font-weight-bold text-gray-800" id="fecha-corte-panel">
                                                --</div>
                                        </div>
                                        <div class="col text-end">
                                            <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row 1: Pesadas (Wide) & Productos (Narrow) -->
                    <div class="row">
                        <!-- Area Chart: Resumen de Pesajes -->
                        <div class="col-xl-8 col-lg-7" data-role="Administrador">
                            <div class="card shadow mb-4">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Resumen de Pesajes</h6>
                                    <select id="select-periodo-pesadas-chart"
                                        class="form-select border-0 bg-light text-primary fw-bold shadow-none"
                                        style="width: auto; font-size: 0.85rem; padding: 6px 30px 6px 12px; cursor: pointer;">
                                        <option value="week">Semana</option>
                                        <option value="month" selected>Mes</option>
                                        <option value="year">Año</option>
                                        <option value="total">Total</option>
                                    </select>
                                </div>
                                <div class="card-body">
                                    <div class="chart-area" style="height: 320px;">
                                        <canvas id="chartPesadas"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Pie Chart: Productos -->
                        <div class="col-xl-4 col-lg-5" data-role="Administrador">
                            <div class="card shadow mb-4">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Productos (Top 5)</h6>
                                </div>
                                <div class="card-body">
                                    <div class="chart-pie pt-4 pb-2" style="height: 250px;">
                                        <canvas id="chartProductos"></canvas>
                                    </div>
                                    <div id="detalles-productos" class="mt-3 small">
                                        <!-- Detalles dinámicos aquí -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row 2: Evaluaciones (Full Width) -->
                    <div class="row">
                        <div class="col-xl-12 col-lg-12">
                            <div class="card shadow mb-4">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Evaluaciones por Tema</h6>
                                </div>
                                <div class="card-body">
                                    <div class="chart-area" style="height: 400px;">
                                        <canvas id="chartEvaluacionesTema"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tablas Row -->
                    <div class="row">
                        <!-- Capacitaciones Recientes -->
                        <div class="col-lg-6 mb-4">
                            <div class="card shadow mb-4" id="capacitaciones_recientes"
                                data-role="Administrador,Capacitador,Aux_Capacitador">
                                <div class="card-header py-3">
                                    <h5 class="fw-bold m-0 text-primary">Capacitaciones Recientes</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive"
                                        style="border-radius: 15px; overflow: hidden; box-shadow: 0 0 10px rgba(0,0,0,0.05);">
                                        <table class="table table-bordered table-striped mb-0" id="tabla-capacitaciones"
                                            width="100%" cellspacing="0">
                                            <thead class="bg-primary text-white">
                                                <tr>
                                                    <th class="border-0">Nombre</th>
                                                    <th class="border-0">Fecha</th>
                                                    <th class="border-0">Asistentes</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Data populated by JS -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Agronomía Reciente -->
                        <div class="col-lg-6 mb-4">
                            <div class="card shadow mb-4" id="agronomia_recientes"
                                data-role="Administrador,Capacitador,Aux_Capacitador">
                                <div class="card-header py-3">
                                    <h5 class="fw-bold m-0 text-primary">Registro Reciente Agronomía</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive"
                                        style="border-radius: 15px; overflow: hidden; box-shadow: 0 0 10px rgba(0,0,0,0.05);">
                                        <table class="table table-bordered table-striped mb-0" id="tabla-agronomia"
                                            width="100%" cellspacing="0">
                                            <thead class="bg-primary text-white">
                                                <tr>
                                                    <th class="border-0">Nombre</th>
                                                    <th class="border-0">Fecha</th>
                                                    <th class="border-0">Can. asistentes</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <!-- Placeholder or JS populated -->
                                                <tr>
                                                    <td>Capacitacion 1</td>
                                                    <td>06/01/2025</td>
                                                    <td>23</td>
                                                </tr>
                                                <tr>
                                                    <td>Capacitacion 2</td>
                                                    <td>08/03/2025</td>
                                                    <td>12</td>
                                                </tr>
                                                <tr>
                                                    <td>Capacitacion 3</td>
                                                    <td>15/05/2025</td>
                                                    <td>34</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- /.container-fluid -->

                <footer class="bg-white sticky-footer">
                    <div class="container my-auto">
                        <div class="text-center my-auto copyright"><span>© OSM 2025</span></div>
                    </div>
                </footer>
            </div>
            <a class="border rounded d-inline scroll-to-top" href="#page-top"><i class="fas fa-angle-up"></i></a>
        </div>
    </div>

    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/main.js?v=5"></script>
    <script src="assets/js/sidebar.js?v=20251213_mobile_nuclear_fix"></script>
    <script src="assets/js/navbar.js?v=5"></script>
    <script src="assets/js/chart.js"></script>
    <script src="assets/js/panel.js?v=2"></script>
    <script src="assets/js/web_config.js"></script>
</body>

</html>