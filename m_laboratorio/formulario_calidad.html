<!DOCTYPE html>
<html data-bs-theme="light" lang="es-419">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>OSM - Formulario de Calidad</title>
    <meta property="og:image" content="../assets/img/Sin%20título-2.png">
    <meta property="og:type" content="website">
    <link rel="icon" type="image/png" sizes="697x475" href="../assets/img/Sin%20título-2.png">
    <link rel="stylesheet" href="../assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/google-fonts.css">
    <link rel="stylesheet" href="../assets/fonts/fontawesome-all.min.css">
    <link rel="stylesheet" href="../assets/css/bs-theme-overrides.css">
    <style>
        body {
            visibility: hidden;
        }
    </style>
</head>

<body id="page-top">
    <div id="wrapper">
        <div id="sidebar"></div>
        <div class="d-flex flex-column" id="content-wrapper">
            <div id="content">
                <div id="navbar"></div>
                <div class="container-fluid">
                    <!-- Alert Container -->
                    <div id="alert-container" class="position-fixed top-0 end-0 p-3 alert-toast-container"></div>

                    <main class="py-3">
                        <!-- Header Card -->
                        <div class="card shadow-sm mb-4">
                            <div class="card-header py-3 d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-2"
                                style="background:rgb(248, 249, 252);">
                                <div>
                                    <h5 class="fw-bold text-primary m-0">
                                        <i class="fas fa-flask me-2"></i>Formulario de Calidad
                                    </h5>
                                    <small class="text-muted">Registro y consulta de mediciones de acidez, humedad y
                                        yodo</small>
                                </div>
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#modal-nueva-medicion">
                                    <i class="fas fa-plus me-2"></i>Nueva Medición
                                </button>
                            </div>
                        </div>

                        <!-- Filter and Tank Selection -->
                        <div class="card shadow-sm mb-4">
                            <div class="card-body">
                                <div class="row g-3 align-items-end">
                                    <div class="col-12 col-md-3">
                                        <label class="form-label fw-bold" for="select-tanque-filtro">
                                            <i class="fas fa-oil-can me-1"></i>Filtrar por Tanque
                                        </label>
                                        <select class="form-select select-tanque" id="select-tanque-filtro">
                                            <option value="">Todos los tanques</option>
                                        </select>
                                    </div>
                                    <div class="col-6 col-md-2">
                                        <label class="form-label fw-bold" for="filtro-tipo-origen">
                                            <i class="fas fa-tags me-1"></i>Tipo Origen
                                        </label>
                                        <select class="form-select" id="filtro-tipo-origen">
                                            <option value="">Todos</option>
                                            <option value="tanque">Tanque</option>
                                            <option value="bombeo">Bombeo (Secador)</option>
                                            <option value="despacho">Despacho</option>
                                        </select>
                                    </div>
                                    <div class="col-6 col-md-2">
                                        <label class="form-label fw-bold" for="fecha-desde">Desde</label>
                                        <input type="date" class="form-control" id="fecha-desde">
                                    </div>
                                    <div class="col-6 col-md-2">
                                        <label class="form-label fw-bold" for="fecha-hasta">Hasta</label>
                                        <input type="date" class="form-control" id="fecha-hasta">
                                    </div>
                                    <div class="col-12 col-md-2">
                                        <label class="form-label fw-bold" for="filtro-tipo">Medición</label>
                                        <select class="form-select" id="filtro-tipo">
                                            <option value="">Todos</option>
                                            <option value="acidez">Acidez</option>
                                            <option value="humedad">Humedad</option>
                                            <option value="yodo">Yodo</option>
                                        </select>
                                    </div>
                                    <div class="col-12 col-md-1">
                                        <button type="button" class="btn btn-outline-primary w-100" id="btn-filtrar">
                                            <i class="fas fa-search"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Measurements Table -->
                        <div class="card shadow-sm">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center"
                                style="background:rgb(248, 249, 252);">
                                <h6 class="fw-bold text-primary m-0">
                                    <i class="fas fa-history me-2"></i>Historial de Mediciones
                                </h6>
                                <span class="badge bg-secondary" id="total-registros">0 registros</span>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-measurements table-hover mb-0">
                                        <thead>
                                            <tr>
                                                <th class="text-center" style="width: 40px;">#</th>
                                                <th class="text-center">Tipo Origen</th>
                                                <th>Origen/Destino</th>
                                                <th class="text-center">Medición</th>
                                                <th class="text-center">Valor</th>
                                                <th class="d-none d-md-table-cell text-center">Toneladas</th>
                                                <th class="d-none d-lg-table-cell">Método</th>
                                                <th>Fecha/Hora</th>
                                                <th class="d-none d-lg-table-cell">Realizado por</th>
                                                <th class="d-none d-xl-table-cell">Observaciones</th>
                                                <th class="text-center" style="width: 80px;">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="measurement-history-body">
                                            <tr>
                                                <td colspan="11" class="text-center text-muted py-4">
                                                    <i class="fas fa-flask fa-2x mb-2 d-block opacity-50"></i>
                                                    Cargando mediciones...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!-- Pagination -->
                            <div
                                class="card-footer d-flex flex-column flex-md-row justify-content-between align-items-center gap-2">
                                <div class="text-muted small">
                                    Mostrando <span id="showing-start">0</span>-<span id="showing-end">0</span> de <span
                                        id="total-items">0</span>
                                </div>
                                <nav>
                                    <ul class="pagination pagination-sm mb-0" id="pagination-container">
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </main>
                </div>
            </div>
            <footer class="bg-white sticky-footer">
                <div class="container my-auto">
                    <div class="text-center my-auto copyright"><span>© OSM 2025</span></div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Modal Nueva Medición -->
    <div class="modal fade" id="modal-nueva-medicion" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">
                        <i class="fas fa-plus-circle me-2"></i>Nueva Medición
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"
                        aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <form id="form-medicion" class="needs-validation" novalidate>
                        <!-- Phase Progress Indicator -->
                        <div class="phase-progress" id="phase-progress">
                            <div class="phase-indicator active" data-phase="1">1</div>
                            <div class="phase-indicator" data-phase="2">2</div>
                            <div class="phase-indicator" data-phase="3">3</div>
                        </div>

                        <!-- Phase 1: Measurement Type & Source Selection -->
                        <div class="phase-step active" id="phase-1">
                            <h6 class="form-section-title">
                                <i class="fas fa-cog me-2"></i>Tipo de Medición
                            </h6>

                            <!-- Measurement Type Selection Cards -->
                            <label class="form-label fw-bold mb-3">
                                <i class="fas fa-clipboard-list me-1"></i>Seleccione el tipo de medición
                            </label>
                            <div class="row g-3 mb-4">
                                <div class="col-12 col-md-4">
                                    <div class="card measurement-type-card h-100 selected" id="card-tipo-tanque"
                                        role="button" tabindex="0" data-tipo="tanque">
                                        <div class="card-body text-center py-4">
                                            <i class="fas fa-oil-can card-icon text-primary mb-2"></i>
                                            <h6 class="mb-1">Tanque</h6>
                                            <small class="text-muted">Medición directa en tanque</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <div class="card measurement-type-card h-100" id="card-tipo-bombeo" role="button"
                                        tabindex="0" data-tipo="bombeo">
                                        <div class="card-body text-center py-4">
                                            <i class="fas fa-water card-icon text-info mb-2"></i>
                                            <h6 class="mb-1">Bombeo</h6>
                                            <small class="text-muted">Desde secador a tanque</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <div class="card measurement-type-card h-100" id="card-tipo-despacho" role="button"
                                        tabindex="0" data-tipo="despacho">
                                        <div class="card-body text-center py-4">
                                            <i class="fas fa-truck card-icon text-success mb-2"></i>
                                            <h6 class="mb-1">Despacho</h6>
                                            <small class="text-muted">Salida de producto</small>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Dynamic Source Selection based on type -->
                            <!-- TANQUE Selection -->
                            <div id="source-tanque" class="source-selection">
                                <div class="mb-4">
                                    <label class="form-label fw-bold" for="select-tanque-principal">
                                        <i class="fas fa-oil-can me-1"></i>Seleccione el Tanque
                                    </label>
                                    <select class="form-select select-tanque" id="select-tanque-principal" required>
                                        <option value="">Seleccione tanque...</option>
                                    </select>
                                    <div class="invalid-feedback">Seleccione un tanque</div>
                                </div>

                                <!-- Tank Info Panel -->
                                <div class="card bg-light mb-4" id="tanque-info-container" style="display: none;">
                                    <div class="card-body py-3" id="tanque-info">
                                    </div>
                                </div>
                            </div>

                            <!-- BOMBEO Selection -->
                            <div id="source-bombeo" class="source-selection" style="display: none;">
                                <div class="row g-3 mb-4">
                                    <div class="col-12 col-md-6">
                                        <label class="form-label fw-bold" for="select-secador">
                                            <i class="fas fa-fan me-1"></i>Seleccione el Secador
                                        </label>
                                        <select class="form-select" id="select-secador" required>
                                            <option value="">Seleccione secador...</option>
                                        </select>
                                        <div class="invalid-feedback">Seleccione un secador</div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <label class="form-label fw-bold" for="select-tanque-destino">
                                            <i class="fas fa-oil-can me-1"></i>Tanque Destino
                                        </label>
                                        <select class="form-select select-tanque" id="select-tanque-destino" required>
                                            <option value="">Seleccione tanque destino...</option>
                                        </select>
                                        <div class="invalid-feedback">Seleccione tanque destino</div>
                                    </div>
                                </div>
                                <div class="row g-3 mb-4">
                                    <div class="col-12 col-md-6">
                                        <label class="form-label fw-bold" for="toneladas-bombeo">
                                            <i class="fas fa-weight me-1"></i>Toneladas Bombeadas
                                        </label>
                                        <input type="number" step="0.01" class="form-control" id="toneladas-bombeo"
                                            placeholder="Ej: 10.50" required>
                                        <div class="invalid-feedback">Ingrese las toneladas</div>
                                    </div>
                                </div>
                                <!-- Secador Info Panel -->
                                <div class="card bg-light mb-4" id="secador-info-container" style="display: none;">
                                    <div class="card-body py-3" id="secador-info">
                                    </div>
                                </div>
                            </div>

                            <!-- DESPACHO Selection -->
                            <div id="source-despacho" class="source-selection" style="display: none;">
                                <div class="row g-3 mb-4">
                                    <div class="col-12 col-md-6">
                                        <label class="form-label fw-bold" for="select-tanque-despacho">
                                            <i class="fas fa-oil-can me-1"></i>Tanque de Origen
                                        </label>
                                        <select class="form-select select-tanque" id="select-tanque-despacho" required>
                                            <option value="">Seleccione tanque...</option>
                                        </select>
                                        <div class="invalid-feedback">Seleccione tanque de origen</div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <label class="form-label fw-bold" for="toneladas-despacho">
                                            <i class="fas fa-weight me-1"></i>Toneladas Despachadas
                                        </label>
                                        <input type="number" step="0.01" class="form-control" id="toneladas-despacho"
                                            placeholder="Ej: 10.50" required>
                                        <div class="invalid-feedback">Ingrese las toneladas</div>
                                    </div>
                                </div>
                                <div class="row g-3 mb-4">
                                    <div class="col-12 col-md-6">
                                        <label class="form-label fw-bold" for="placa-vehiculo">
                                            <i class="fas fa-truck me-1"></i>Placa del Vehículo
                                        </label>
                                        <input type="text" class="form-control" id="placa-vehiculo"
                                            placeholder="Ej: ABC-123" required>
                                        <div class="invalid-feedback">Ingrese la placa</div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <label class="form-label fw-bold" for="responsable-vehiculo">
                                            <i class="fas fa-user me-1"></i>Responsable del Vehículo
                                        </label>
                                        <input type="text" class="form-control" id="responsable-vehiculo"
                                            placeholder="Nombre del conductor" required>
                                        <div class="invalid-feedback">Ingrese el responsable</div>
                                    </div>
                                </div>
                            </div>

                            <hr class="my-3">

                            <!-- Measurement Selection Cards -->
                            <label class="form-label fw-bold mb-3">
                                <i class="fas fa-tasks me-1"></i>Seleccione las mediciones a realizar
                            </label>
                            <div class="row g-3 mb-4">
                                <div class="col-12 col-md-4">
                                    <div class="card measurement-card h-100" id="card-acidez" role="button" tabindex="0"
                                        aria-pressed="false" data-measurement="acidez">
                                        <div class="card-body text-center py-4">
                                            <i class="fas fa-vial card-icon text-success mb-2"></i>
                                            <h6 class="mb-1">Acidez</h6>
                                            <small class="text-muted">%AGL</small>
                                            <div class="form-check d-flex justify-content-center mt-2">
                                                <input class="form-check-input" type="checkbox" id="check-acidez">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <div class="card measurement-card h-100" id="card-humedad" role="button"
                                        tabindex="0" aria-pressed="false" data-measurement="humedad">
                                        <div class="card-body text-center py-4">
                                            <i class="fas fa-tint card-icon text-info mb-2"></i>
                                            <h6 class="mb-1">Humedad</h6>
                                            <small class="text-muted">%</small>
                                            <div class="form-check d-flex justify-content-center mt-2">
                                                <input class="form-check-input" type="checkbox" id="check-humedad">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-md-4">
                                    <div class="card measurement-card h-100" id="card-yodo" role="button" tabindex="0"
                                        aria-pressed="false" data-measurement="yodo">
                                        <div class="card-body text-center py-4">
                                            <i class="fas fa-atom card-icon text-warning mb-2"></i>
                                            <h6 class="mb-1">Yodo</h6>
                                            <small class="text-muted">Índice</small>
                                            <div class="form-check d-flex justify-content-center mt-2">
                                                <input class="form-check-input" type="checkbox" id="check-yodo">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="no-selection-warning" class="alert alert-warning" style="display: none;">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Seleccione al menos una medición para continuar.
                            </div>
                        </div>

                        <!-- Phase 2: Measurement Data Entry -->
                        <div class="phase-step" id="phase-2">
                            <!-- Acidez Section -->
                            <div id="section-acidez" class="form-section" style="display: none;">
                                <h6 class="form-section-title text-success">
                                    <i class="fas fa-vial me-2"></i>Acidez - %AGL
                                </h6>

                                <!-- Manual Toggle -->
                                <div class="manual-toggle">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="manual-acidez">
                                        <label class="form-check-label" for="manual-acidez">
                                            <i class="fas fa-keyboard me-1"></i>Ingresar valor manualmente
                                        </label>
                                    </div>
                                </div>

                                <!-- Manual Value Input -->
                                <div id="acidez-manual-input" class="mb-3" style="display: none;">
                                    <label class="form-label" for="valor-manual-acidez">Valor %AGL</label>
                                    <input type="number" step="0.0001" class="form-control form-control-lg"
                                        id="valor-manual-acidez" placeholder="Ingrese el valor de acidez">
                                </div>

                                <!-- Formula-based Input -->
                                <div id="acidez-formula-input">
                                    <p class="small text-muted mb-3">
                                        <i class="fas fa-info-circle me-1"></i>
                                        Fórmula: %AGL = (25.6 × V × N) / W
                                    </p>
                                    <div class="row g-3">
                                        <div class="col-6 col-md-3">
                                            <label class="form-label" for="cantidad-muestra-acidez">Cantidad Muestra
                                                (g)</label>
                                            <input type="number" step="0.0001" class="form-control"
                                                id="cantidad-muestra-acidez" placeholder="Gramos">
                                        </div>
                                        <div class="col-6 col-md-3">
                                            <label class="form-label" for="peso-muestra-w">Peso Muestra W (g)</label>
                                            <input type="number" step="0.0001" class="form-control" id="peso-muestra-w"
                                                placeholder="W">
                                        </div>
                                        <div class="col-6 col-md-3">
                                            <label class="form-label" for="normalidad-n">Normalidad N</label>
                                            <input type="number" step="0.0001" class="form-control" id="normalidad-n"
                                                value="0.1" readonly>
                                        </div>
                                        <div class="col-6 col-md-3">
                                            <label class="form-label" for="volumen-naoh-v">Volumen NaOH V (ml)</label>
                                            <input type="number" step="0.0001" class="form-control" id="volumen-naoh-v"
                                                placeholder="V">
                                        </div>
                                    </div>
                                    <div class="row g-3 mt-2">
                                        <div class="col-12 col-md-4">
                                            <label class="form-label" for="resultado-acidez">Resultado %AGL</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control bg-light" id="resultado-acidez"
                                                    readonly>
                                                <button type="button" class="btn btn-success" id="btn-calc-acidez">
                                                    <i class="fas fa-calculator"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr class="my-3">
                                <div class="row g-3">
                                    <div class="col-12 col-md-6">
                                        <label class="form-label" for="lugar-muestreo-acidez">Lugar de Muestreo</label>
                                        <select class="form-select select-lugar-muestreo" id="lugar-muestreo-acidez">
                                            <option value="">Seleccione...</option>
                                        </select>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <label class="form-label" for="cedula-acidez">Quién Realiza (Cédula)</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="cedula-acidez"
                                                placeholder="Cédula">
                                            <button type="button" class="btn btn-outline-success"
                                                id="btn-search-colaborador-acidez">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                        <input type="text" class="form-control mt-2" id="nombre-acidez" readonly
                                            placeholder="Nombre del colaborador">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label" for="observaciones-acidez">Observaciones</label>
                                        <textarea class="form-control" id="observaciones-acidez" rows="2"
                                            placeholder="Observaciones opcionales..."></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Humedad Section -->
                            <div id="section-humedad" class="form-section" style="display: none;">
                                <h6 class="form-section-title text-info">
                                    <i class="fas fa-tint me-2"></i>Humedad - %
                                </h6>

                                <!-- Manual Toggle -->
                                <div class="manual-toggle">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="manual-humedad">
                                        <label class="form-check-label" for="manual-humedad">
                                            <i class="fas fa-keyboard me-1"></i>Ingresar valor manualmente
                                        </label>
                                    </div>
                                </div>

                                <!-- Manual Value Input -->
                                <div id="humedad-manual-input" class="mb-3" style="display: none;">
                                    <label class="form-label" for="valor-manual-humedad">Valor % Humedad</label>
                                    <input type="number" step="0.0001" class="form-control form-control-lg"
                                        id="valor-manual-humedad" placeholder="Ingrese el valor de humedad">
                                </div>

                                <!-- Formula-based Input -->
                                <div id="humedad-formula-input">
                                    <p class="small text-muted mb-3">
                                        <i class="fas fa-info-circle me-1"></i>
                                        Fórmulas: D = C - A | E = B - C | %Humedad = (E / B) × 100
                                    </p>
                                    <div class="row g-3">
                                        <div class="col-6 col-md-4">
                                            <label class="form-label" for="peso-recipiente-a">Peso Recipiente A
                                                (g)</label>
                                            <input type="number" step="0.0001" class="form-control"
                                                id="peso-recipiente-a" placeholder="A">
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <label class="form-label" for="peso-muestra-humedad-b">Peso Muestra B
                                                (g)</label>
                                            <input type="number" step="0.0001" class="form-control"
                                                id="peso-muestra-humedad-b" placeholder="B">
                                        </div>
                                        <div class="col-12 col-md-4">
                                            <label class="form-label" for="peso-muestra-seca-c">Muestra Seca +
                                                Recipiente C (g)</label>
                                            <input type="number" step="0.0001" class="form-control"
                                                id="peso-muestra-seca-c" placeholder="C">
                                        </div>
                                    </div>
                                    <div class="row g-3 mt-2">
                                        <div class="col-4 col-md-3">
                                            <label class="form-label" for="peso-muestra-seca-d">Peso Seca D</label>
                                            <input type="text" class="form-control bg-light" id="peso-muestra-seca-d"
                                                readonly placeholder="C-A">
                                        </div>
                                        <div class="col-4 col-md-3">
                                            <label class="form-label" for="peso-agua-e">Peso Agua E</label>
                                            <input type="text" class="form-control bg-light" id="peso-agua-e" readonly
                                                placeholder="B-C">
                                        </div>
                                        <div class="col-4 col-md-4">
                                            <label class="form-label" for="resultado-humedad">Resultado %</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control bg-light" id="resultado-humedad"
                                                    readonly>
                                                <button type="button" class="btn btn-info text-white"
                                                    id="btn-calc-humedad">
                                                    <i class="fas fa-calculator"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr class="my-3">
                                <div class="row g-3">
                                    <div class="col-12 col-md-6">
                                        <label class="form-label" for="lugar-muestreo-humedad">Lugar de Muestreo</label>
                                        <select class="form-select select-lugar-muestreo" id="lugar-muestreo-humedad">
                                            <option value="">Seleccione...</option>
                                        </select>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <label class="form-label" for="cedula-humedad">Quién Realiza (Cédula)</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="cedula-humedad"
                                                placeholder="Cédula">
                                            <button type="button" class="btn btn-outline-info"
                                                id="btn-search-colaborador-humedad">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                        <input type="text" class="form-control mt-2" id="nombre-humedad" readonly
                                            placeholder="Nombre del colaborador">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label" for="observaciones-humedad">Observaciones</label>
                                        <textarea class="form-control" id="observaciones-humedad" rows="2"
                                            placeholder="Observaciones opcionales..."></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Yodo Section -->
                            <div id="section-yodo" class="form-section" style="display: none;">
                                <h6 class="form-section-title text-warning">
                                    <i class="fas fa-atom me-2"></i>Yodo - Índice
                                </h6>

                                <!-- Manual Toggle -->
                                <div class="manual-toggle">
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="manual-yodo">
                                        <label class="form-check-label" for="manual-yodo">
                                            <i class="fas fa-keyboard me-1"></i>Ingresar valor manualmente
                                        </label>
                                    </div>
                                </div>

                                <!-- Manual Value Input -->
                                <div id="yodo-manual-input" class="mb-3" style="display: none;">
                                    <label class="form-label" for="valor-manual-yodo">Valor Índice de Yodo</label>
                                    <input type="number" step="0.0001" class="form-control form-control-lg"
                                        id="valor-manual-yodo" placeholder="Ingrese el valor de yodo">
                                </div>

                                <!-- Formula-based Input -->
                                <div id="yodo-formula-input">
                                    <p class="small text-muted mb-3">
                                        <i class="fas fa-info-circle me-1"></i>
                                        Fórmula: Índice de Yodo = (12.69 × 0.1 × (VB - VA)) / W
                                    </p>
                                    <div class="row g-3">
                                        <div class="col-6 col-md-4">
                                            <label class="form-label" for="peso-aceite-w">Peso Aceite W (g)</label>
                                            <input type="number" step="0.0001" class="form-control" id="peso-aceite-w"
                                                placeholder="W">
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <label class="form-label" for="volumen-blanco-vb">Volumen Blanco VB</label>
                                            <input type="number" step="0.0001" class="form-control"
                                                id="volumen-blanco-vb" placeholder="VB">
                                        </div>
                                        <div class="col-6 col-md-4">
                                            <label class="form-label" for="volumen-aceite-va">Volumen Aceite VA</label>
                                            <input type="number" step="0.0001" class="form-control"
                                                id="volumen-aceite-va" placeholder="VA">
                                        </div>
                                    </div>
                                    <div class="row g-3 mt-2">
                                        <div class="col-12 col-md-4">
                                            <label class="form-label" for="resultado-yodo">Resultado Índice</label>
                                            <div class="input-group">
                                                <input type="text" class="form-control bg-light" id="resultado-yodo"
                                                    readonly>
                                                <button type="button" class="btn btn-warning" id="btn-calc-yodo">
                                                    <i class="fas fa-calculator"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr class="my-3">
                                <div class="row g-3">
                                    <div class="col-12 col-md-6">
                                        <label class="form-label" for="lugar-muestreo-yodo">Lugar de Muestreo</label>
                                        <select class="form-select select-lugar-muestreo" id="lugar-muestreo-yodo">
                                            <option value="">Seleccione...</option>
                                        </select>
                                    </div>
                                    <div class="col-12 col-md-6">
                                        <label class="form-label" for="cedula-yodo">Quién Realiza (Cédula)</label>
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="cedula-yodo"
                                                placeholder="Cédula">
                                            <button type="button" class="btn btn-outline-warning"
                                                id="btn-search-colaborador-yodo">
                                                <i class="fas fa-search"></i>
                                            </button>
                                        </div>
                                        <input type="text" class="form-control mt-2" id="nombre-yodo" readonly
                                            placeholder="Nombre del colaborador">
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label" for="observaciones-yodo">Observaciones</label>
                                        <textarea class="form-control" id="observaciones-yodo" rows="2"
                                            placeholder="Observaciones opcionales..."></textarea>
                                    </div>
                                </div>
                            </div>

                            <div id="no-data-warning" class="alert alert-info" style="display: none;">
                                <i class="fas fa-info-circle me-2"></i>
                                Complete los datos de al menos una medición.
                            </div>
                        </div>

                        <!-- Phase 3: Confirmation -->
                        <div class="phase-step" id="phase-3">
                            <h6 class="form-section-title">
                                <i class="fas fa-check-circle me-2"></i>Resumen de Mediciones
                            </h6>

                            <div class="card mb-3">
                                <div class="card-body" id="summary-container">
                                    <!-- Summary will be populated by JavaScript -->
                                </div>
                            </div>

                            <div class="alert alert-success">
                                <i class="fas fa-info-circle me-2"></i>
                                Revise los datos antes de guardar. Una vez guardados, las mediciones quedarán
                                registradas en el sistema.
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-outline-primary" id="btn-prev-phase" style="display: none;">
                        <i class="fas fa-arrow-left me-1"></i>Anterior
                    </button>
                    <button type="button" class="btn btn-primary" id="btn-next-phase">
                        Siguiente<i class="fas fa-arrow-right ms-1"></i>
                    </button>
                    <button type="button" class="btn btn-success" id="btn-save" style="display: none;">
                        <i class="fas fa-save me-1"></i>Guardar Mediciones
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal View Details -->
    <div class="modal fade" id="modal-ver-detalle" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-eye me-2"></i>Detalle de Medición
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="detalle-medicion-body">
                    <!-- Detail content will be populated by JavaScript -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="../assets/js/auth_guard.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/sidebar.js?v=5"></script>
    <script src="../assets/js/navbar.js"></script>
    <script src="assets/js/laboratorio.js"></script>
    <script src="../assets/js/web_config.js"></script>
</body>

</html>